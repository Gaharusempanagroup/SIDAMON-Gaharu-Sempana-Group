async function submitForm() {
      const form = document.getElementById('formInputData');
      if (!form.checkValidity()) { form.reportValidity(); return; }

      // --- LOGIKA BARU: CEK DUPLIKASI DATA ---
      // Ambil nilai input dan bersihkan spasi/huruf kapital agar pencarian akurat
      const namaInput = document.getElementById('inputNama').value.trim().toLowerCase();
      const sertifikatInput = document.getElementById('inputSertifikat').value.trim().toLowerCase();
      let editRowNumber = document.getElementById('editRowNumber').value;
      if (!editRowNumber) editRowNumber = "";

      // Cek apakah data sudah ada di dataSKK
      const isDuplicate = dataSKK.some(row => {
          const rowNama = (row[1] || "").toString().toLowerCase().trim();
          const rowSertifikat = (row[5] || "").toString().toLowerCase().trim();
          const rowID = row[row.length - 1]; // Mengambil ID unik (biasanya kolom terakhir)

          // Jika Nama DAN Sertifikat sama
          if (rowNama === namaInput && rowSertifikat === sertifikatInput) {
              // KONDISI EDIT: Jika ID row sama dengan yang sedang diedit, 
              // berarti ini data sendiri (bukan duplikat), return false.
              if (editRowNumber && String(rowID) === String(editRowNumber)) {
                  return false; 
              }
              // Jika ID beda (milik orang lain) atau sedang Tambah Baru, return true (Duplikat).
              return true;
          }
          return false;
      });

      // Jika ditemukan duplikat, stop proses dan munculkan alert
      if (isDuplicate) {
          myModal.hide(); // Tutup modal input
          Swal.fire({
              title: 'Data Sudah Ada!',
              text: `Personil "${document.getElementById('inputNama').value}" dengan sertifikat "${document.getElementById('inputSertifikat').value}" sudah terdaftar.`,
              icon: 'warning',
              confirmButtonColor: '#000080',
              confirmButtonText: 'Cek Kembali'
          }).then(() => {
              myModal.show(); // Buka kembali modal agar user bisa ganti
          });
          return; // Hentikan eksekusi fungsi
      }
      // --- AKHIR LOGIKA BARU ---

      myModal.hide(); 
      setTimeout(() => {
        Swal.fire({
          title: 'Konfirmasi Password', text: 'Masukkan password Anda untuk menyimpan:', input: 'password',
          inputAttributes: { autocapitalize: 'off', placeholder: 'Password' }, showCancelButton: true, confirmButtonText: 'Simpan', confirmButtonColor: '#000080',
          preConfirm: (password) => { if (!password) { Swal.showValidationMessage('Password wajib diisi!'); } return password; }
        }).then(async (result) => {
          if (result.isConfirmed) {
            const passwordInput = result.value;
            const payload = {
              actionPassword: passwordInput, rowNumber: editRowNumber, 
              nama: document.getElementById('inputNama').value, perusahaan: document.getElementById('inputPerusahaan').value,
              sertifikat: document.getElementById('inputSertifikat').value, jenjang: document.getElementById('inputJenjang').value,
              asosiasi: document.getElementById('inputAsosiasi').value, masaBerlaku: document.getElementById('inputMasaBerlaku').value,
              keterangan: document.getElementById('inputKeterangan').value
            };
            document.getElementById('loading-overlay').style.display = 'flex'; document.getElementById('loading-text').innerText = "Menyimpan Data...";
            
            try {
                const response = await fetchAPI('saveData', 'POST', { password: passwordInput, payload: payload });
                document.getElementById('loading-overlay').style.display = 'none'; document.getElementById('loading-text').innerText = "Memuat Data...";
                if(response === "Sukses") { Swal.fire('Berhasil!', 'Data berhasil disimpan.', 'success'); document.getElementById('formInputData').reset(); loadAllData(); } 
                else { Swal.fire('Gagal!', response, 'error').then(() => { if(response.includes("Password")) myModal.show(); }); }
            } catch (err) {
                 document.getElementById('loading-overlay').style.display = 'none'; Swal.fire('Error', err.message, 'error');
            }
          } else { myModal.show(); }
        });
      }, 300);
    }
